---
title: State
---

import ThemedImage from '@theme/ThemedImage';

A state describes the machine’s status or mode, which could be as simple as *Paused* and *Playing*. A state machine can only be in one state at a time.

:::tip

Watch our [“What are states?” video on YouTube](https://www.youtube.com/watch?v=z-6yhmSWUcc&list=PLvWgkXBB3dd4I_l-djWVU2UGPyBgKfnTQ&index=2) (53s).

:::

<details>
<summary>
Stately Studio: states
</summary>

<p>
  <ThemedImage
    alt="Video player state machine with an initial Paused state and a Playing state. There’s a warning on the playing state because there’s no transitions which means the playing state cannot be reached."
    sources={{
      light:
        'https://stately.ai/registry/machines/741f69fd-7f01-4932-9407-6871e225bb6d.light.png',
      dark: 'https://stately.ai/registry/machines/741f69fd-7f01-4932-9407-6871e225bb6d.dark.png',
    }}
  />
</p>

[View this machine in the Stately Studio](https://stately.ai/registry/editor/e13bef2b-bb13-4465-96ac-0bc25340688e?machineId=741f69fd-7f01-4932-9407-6871e225bb6d).

:::studio

In the Stately Studio, the rounded rectangle boxes are states. The **?** question mark icon in the machine above indicates an unreachable state. The state is unreachable because it isn’t connected to the [initial state](initial-states.mdx) by a [transition](transitions.mdx).

:::

These states are “finite”; the machine can only move through the states you’ve pre-defined.

## Using states in the Studio

### Create a state

1. Select your machine or an existing state.
2. Create a new state inside your machine or existing state:
   - Use the **+ State** button that appears above the selected state, or:
   - Drag from the handles on the left, right and bottom sides of the selected state, and release to create a connecting transition, event and new state.
   - Double-click inside your machine or an existing state.

</details>

## State object

The state object represents the current state of a running machine (actor). It contains the following properties:

- `value` - the current state value, which is either a string representing a simple state like `'playing'` or an object representing nested states like `{ paused: 'buffering' }`
- `context` - the current [context](#todo) (extended state)
- `meta` - an object containing state node meta data

```ts
const feedbackMachine = createMachine({
  id: 'feedback',
  initial: 'question',
  context: {
    feedback: '',
  },
  states: {
    question: {
      meta: {
        question: 'How was your experience?',
      },
    },
  },
});

const actor = interpret(feedbackMachine);
actor.start();

console.log(actor.getSnapshot());
// Logs an object containing:
// {
//   value: 'question',
//   context: {
//     feedback: ''
//   },
//   meta: {
//     'feedback.question': {
//       question: 'How was your experience?'
//     }
//   }
// }
```

## Accessing state snapshots

You can access the snapshot of an actor (its emitted state) by subscribing to it or reading from the actor’s `.getSnapshot()` method.

```ts
const actor = interpret(feedbackMachine);

actor.subscribe((snapshot) => {
  console.log(snapshot);
  // logs the current snapshot state, e.g.:
  // { value: 'question', ... }
  // { value: 'thanks', ... }
});

actor.start();

console.log(actor.getSnapshot());
// logs { value: 'question', ... }
```

## State value

A state machine with nested states (statechart) is a tree-like structure, where each node is a "state node". The root state node is the top-level state node that represents the entire machine. It may have child state nodes, and those may have child state nodes, and so on.

The **state value** is an object that represents all of the active state nodes in a machine. For state machines that have state nodes without child state nodes, the state value is a string:

TODO: make this a visual example

- `state.value === 'question'`
- `state.value === 'thanks'`
- `state.value === 'closed'`

For state machines with parent state nodes, the state value is an object:

TODO: make this a visual example

- `state.value === { form: 'invalid' }` - this represents a state machine with an active child node with key `form` that has an active child node with key `invalid`

For state machines with [parallel state nodes](#todo), the state value contains object(s) with multiple keys for each state node region:

```ts
state.value ===
  {
    monitor: 'on',
    mode: 'dark',
  };
```

State machines may also have no state nodes other than the root state node. For these state machines, the state value is `null`.

## State context

## `state.can(eventType)`

## `state.hasTag(tag)`

## `state.matches(stateValue)`

- Prefer `state.hasTag(tag)`

## `state.output`

- `state.done` will be `true`

## `state.nextEvents`

## `state.meta`

## `state.toStrings`

## TypeScript

## Cheatsheet

## Resources

- Persisting state
